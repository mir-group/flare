

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OTF Parser &mdash; flare 1.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=02f2166e"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Utility" href="../utils/utils.html" />
    <link rel="prev" title="Output" href="output.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            flare
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../flare.html">Python Code Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bffs/bffs.html">Bayesian Force Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learners/learners.html">Bayesian Active Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../md/md.html">ASE MD Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../descriptors/descriptors.html">Descriptors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernels/kernels.html">Kernels</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="io.html">File Input and Output</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">OTF Parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.OtfAnalysis"><code class="docutils literal notranslate"><span class="pre">OtfAnalysis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.append_atom_lists"><code class="docutils literal notranslate"><span class="pre">append_atom_lists()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.extract_gp_info"><code class="docutils literal notranslate"><span class="pre">extract_gp_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.parse_frame_line"><code class="docutils literal notranslate"><span class="pre">parse_frame_line()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.parse_header_information"><code class="docutils literal notranslate"><span class="pre">parse_header_information()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.parse_snapshot"><code class="docutils literal notranslate"><span class="pre">parse_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.io.otf_parser.strip_and_split"><code class="docutils literal notranslate"><span class="pre">strip_and_split()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/utils.html">Utility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../flare_pp/flare_pp.html">C++ Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../related.html">Applications/Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/contribute.html">How To Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">How to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">flare</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../flare.html">Python Code Documentation</a></li>
          <li class="breadcrumb-item"><a href="io.html">File Input and Output</a></li>
      <li class="breadcrumb-item active">OTF Parser</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/flare/io/otf_parser.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-flare.io.otf_parser">
<span id="otf-parser"></span><h1>OTF Parser<a class="headerlink" href="#module-flare.io.otf_parser" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="flare.io.otf_parser.OtfAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">OtfAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.OtfAnalysis" title="Link to this definition"></a></dt>
<dd><p>Parse the OTF log file to get trajectory, training data,
thermostat, and build GP model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of the OTF log file.</p></li>
<li><p><strong>calculate_energy</strong> (<em>bool</em>) – if the potential energy is computed and
needs to be parsed, then set to True. Default False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="flare.io.otf_parser.OtfAnalysis.make_gp">
<span class="sig-name descname"><span class="pre">make_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_gp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyp_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.OtfAnalysis.make_gp" title="Link to this definition"></a></dt>
<dd><p>Build GP model from the training frames parsed from the log file.
The cell, hyps and gp can be reset with customized values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> (<em>np.ndarray</em>) – Default None to use the cell from the log file.
A customized cell can be input as a 3x3 numpy array.</p></li>
<li><p><strong>call_no</strong> (<em>int</em>) – Default None to use all the DFT frames as training
data for building GP. If not None, then the frames 0 to <cite>call_no</cite>
will be added to GP.</p></li>
<li><p><strong>hyps</strong> (<em>np.ndarray</em>) – Default None to use the hyperparameters from the
log file. Customized hyps can be input as an array.</p></li>
<li><p><strong>init_gp</strong> (<em>GaussianProcess</em>) – Default to None to use no initial settings
or training data. an initial GP can be used, and then the
frames parsed in the log file will add to the initial GP. Then the
final GP uses the hyps and kernels of <cite>init_gp</cite>, and consists of
training data from <cite>init_gp</cite> and the data from the log file.
<strong>NOTE</strong>: if a log file from restarted OTF is parsed, then an initial
GP needs to be parsed from the prior log file as the <cite>init_gp</cite> of the
restarted log file.</p></li>
<li><p><strong>hyp_no</strong> (<em>int</em>) – Default None to use the final optimized hyperparameters to
build GP. If not None, then use the hyps from the <a href="#id1"><span class="problematic" id="id2">`</span></a>hyp_no`th
optimization step.</p></li>
<li><p><strong>kwargs</strong> – if a new GP setting is needed without inputing <cite>init_gp</cite>, the GP
initial args can be input as kwargs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flare.io.otf_parser.OtfAnalysis.output_md_structures">
<span class="sig-name descname"><span class="pre">output_md_structures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.OtfAnalysis.output_md_structures" title="Link to this definition"></a></dt>
<dd><p>Returns structure objects corresponding to the MD frames of an OTF run.
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flare.io.otf_parser.OtfAnalysis.parse_pos_otf">
<span class="sig-name descname"><span class="pre">parse_pos_otf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.OtfAnalysis.parse_pos_otf" title="Link to this definition"></a></dt>
<dd><p>Exclusively parses MD run information
:param filename:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flare.io.otf_parser.OtfAnalysis.to_xyz">
<span class="sig-name descname"><span class="pre">to_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.OtfAnalysis.to_xyz" title="Link to this definition"></a></dt>
<dd><p>Convert OTF trajectory from log file to .xyz file.
:Parameters: <strong>xyz_file</strong> (<em>str</em>) – the file name of the .xyz file to output</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of <cite>ASE Atoms</cite> objects.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.io.otf_parser.append_atom_lists">
<span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">append_atom_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dft_call</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#flare.io.otf_parser.append_atom_lists" title="Link to this definition"></a></dt>
<dd><p>Update lists containing atom information at each snapshot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.io.otf_parser.extract_gp_info">
<span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">extract_gp_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maf_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyps_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.extract_gp_info" title="Link to this definition"></a></dt>
<dd><p>Exclusively parses DFT run information
:param filename:
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.io.otf_parser.parse_frame_line">
<span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">parse_frame_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_line</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.parse_frame_line" title="Link to this definition"></a></dt>
<dd><p>parse a line in otf output.
:param frame_line: frame line to be parsed
:type frame_line: string
:return: species, position, force, uncertainty, and velocity of atom
:rtype: list, np.arrays</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.io.otf_parser.parse_header_information">
<span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">parse_header_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#flare.io.otf_parser.parse_header_information" title="Link to this definition"></a></dt>
<dd><p>Get information about the run from the header of the file
:param outfile:
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.io.otf_parser.parse_snapshot">
<span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">parse_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dft_call</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.parse_snapshot" title="Link to this definition"></a></dt>
<dd><p>Parses snapshot of otf output file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.io.otf_parser.strip_and_split">
<span class="sig-prename descclassname"><span class="pre">flare.io.otf_parser.</span></span><span class="sig-name descname"><span class="pre">strip_and_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.io.otf_parser.strip_and_split" title="Link to this definition"></a></dt>
<dd><p>Helper function which saves a few lines of code elsewhere
:param line:
:return:</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="output.html" class="btn btn-neutral float-left" title="Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../utils/utils.html" class="btn btn-neutral float-right" title="Utility" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jonathan Vandermause, Yu Xie, Anders Johansson, Cameron Owen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>