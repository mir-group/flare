

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multi-element Kernels (Separate Parameters) &mdash; flare 1.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=02f2166e"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cutoff Functions" href="cutoffs.html" />
    <link rel="prev" title="Multi-element Kernels (simple)" href="mc_simple.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            flare
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../flare.html">Python Code Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bffs/bffs.html">Bayesian Force Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learners/learners.html">Bayesian Active Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../md/md.html">ASE MD Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../descriptors/descriptors.html">Descriptors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="kernels.html">Kernels</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="sc.html">Single-element Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_simple.html">Multi-element Kernels (simple)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Multi-element Kernels (Separate Parameters)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.many_body_mc"><code class="docutils literal notranslate"><span class="pre">many_body_mc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.many_body_mc_en"><code class="docutils literal notranslate"><span class="pre">many_body_mc_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.many_body_mc_force_en"><code class="docutils literal notranslate"><span class="pre">many_body_mc_force_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.many_body_mc_grad"><code class="docutils literal notranslate"><span class="pre">many_body_mc_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.three_body_mc"><code class="docutils literal notranslate"><span class="pre">three_body_mc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.three_body_mc_en"><code class="docutils literal notranslate"><span class="pre">three_body_mc_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.three_body_mc_force_en"><code class="docutils literal notranslate"><span class="pre">three_body_mc_force_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.three_body_mc_force_en_jit"><code class="docutils literal notranslate"><span class="pre">three_body_mc_force_en_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.three_body_mc_grad"><code class="docutils literal notranslate"><span class="pre">three_body_mc_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.three_body_mc_grad_jit"><code class="docutils literal notranslate"><span class="pre">three_body_mc_grad_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc"><code class="docutils literal notranslate"><span class="pre">two_body_mc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_en"><code class="docutils literal notranslate"><span class="pre">two_body_mc_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_en_jit"><code class="docutils literal notranslate"><span class="pre">two_body_mc_en_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_force_en"><code class="docutils literal notranslate"><span class="pre">two_body_mc_force_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_force_en_jit"><code class="docutils literal notranslate"><span class="pre">two_body_mc_force_en_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_grad"><code class="docutils literal notranslate"><span class="pre">two_body_mc_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_grad_jit"><code class="docutils literal notranslate"><span class="pre">two_body_mc_grad_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_body_mc_jit"><code class="docutils literal notranslate"><span class="pre">two_body_mc_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_plus_three_body_mc"><code class="docutils literal notranslate"><span class="pre">two_plus_three_body_mc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_plus_three_body_mc_grad"><code class="docutils literal notranslate"><span class="pre">two_plus_three_body_mc_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_plus_three_mc_en"><code class="docutils literal notranslate"><span class="pre">two_plus_three_mc_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_plus_three_mc_force_en"><code class="docutils literal notranslate"><span class="pre">two_plus_three_mc_force_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_three_many_body_mc"><code class="docutils literal notranslate"><span class="pre">two_three_many_body_mc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_three_many_body_mc_grad"><code class="docutils literal notranslate"><span class="pre">two_three_many_body_mc_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_three_many_mc_en"><code class="docutils literal notranslate"><span class="pre">two_three_many_mc_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_sephyps.two_three_many_mc_force_en"><code class="docutils literal notranslate"><span class="pre">two_three_many_mc_force_en()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_3b_sepcut.three_body_mc_force_en_sepcut_jit"><code class="docutils literal notranslate"><span class="pre">three_body_mc_force_en_sepcut_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_3b_sepcut.three_body_mc_grad_sepcut_jit"><code class="docutils literal notranslate"><span class="pre">three_body_mc_grad_sepcut_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_mb_sepcut.many_body_mc_en_sepcut_jit"><code class="docutils literal notranslate"><span class="pre">many_body_mc_en_sepcut_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_mb_sepcut.many_body_mc_force_en_sepcut_jit"><code class="docutils literal notranslate"><span class="pre">many_body_mc_force_en_sepcut_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_mb_sepcut.many_body_mc_grad_sepcut_jit"><code class="docutils literal notranslate"><span class="pre">many_body_mc_grad_sepcut_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flare.kernels.mc_mb_sepcut.many_body_mc_sepcut_jit"><code class="docutils literal notranslate"><span class="pre">many_body_mc_sepcut_jit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cutoffs.html">Cutoff Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="helper.html">Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../io/io.html">File Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/utils.html">Utility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../flare_pp/flare_pp.html">C++ Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../related.html">Applications/Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/contribute.html">How To Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">How to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">flare</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../flare.html">Python Code Documentation</a></li>
          <li class="breadcrumb-item"><a href="kernels.html">Kernels</a></li>
      <li class="breadcrumb-item active">Multi-element Kernels (Separate Parameters)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/flare/kernels/mc_sephyps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-flare.kernels.mc_sephyps">
<span id="multi-element-kernels-separate-parameters"></span><h1>Multi-element Kernels (Separate Parameters)<a class="headerlink" href="#module-flare.kernels.mc_sephyps" title="Link to this heading"></a></h1>
<p>Multicomponent kernels (simple) restrict all signal variance and length scale of hyperparameters
to a single value. The kernels in this module allow you to have different sets of hyperparameters
and cutoffs for different interactions, and have flexible groupings of elements. It also allows
you to do partial hyper-parameter training, keeping some components fixed.</p>
<p>To use this set of kernels, we need a hyps_mask dictionary for GaussianProcess, MappedGaussianProcess,
and AtomicEnvironment (if you also set up different cutoffs).  A simple example is shown below.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">flare.util.parameter_helper</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParameterHelper</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">flare.bffs.gp</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianProcess</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pm</span> <span class="o">=</span> <span class="n">ParameterHelper</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="n">kernels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;twobody&#39;</span><span class="p">:[[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">]],</span>
<span class="gp">... </span>                              <span class="s1">&#39;threebody&#39;</span><span class="p">:[[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]]},</span>
<span class="gp">... </span>                     <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;twobody0&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;twobody1&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                           <span class="s1">&#39;triplet0&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="s1">&#39;triplet1&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>                           <span class="s1">&#39;cutoff_twobody&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cutoff_threebody&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
<span class="gp">... </span>                     <span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;twobody0&#39;</span><span class="p">:[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyps_mask</span> <span class="o">=</span> <span class="n">pm1</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyps</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hyps&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cutoffs</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cutoffs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyp_labels</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hyp_labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernels</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="p">[</span><span class="s1">&#39;kernels&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gp_model</span> <span class="o">=</span> <span class="n">GaussianProcess</span><span class="p">(</span><span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">hyps</span><span class="o">=</span><span class="n">hyps</span><span class="p">,</span> <span class="n">cutoffs</span><span class="o">=</span><span class="n">cutoffs</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">hyp_labels</span><span class="o">=</span><span class="n">hyp_labels</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">per_atom_par</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">n_cpus</span><span class="o">=</span><span class="n">n_cpus</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">multihyps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hyps_mask</span><span class="o">=</span><span class="n">hm</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above, Parameters class generates the arrays needed
for these kernels and store all the grouping and mapping information in the
hyps_mask dictionary.  It stores following keys and values:</p>
<ul class="simple">
<li><dl class="simple">
<dt>spec_mask: 118-long integer array descirbing which elements belong to</dt><dd><p>like groups for determining which bond hyperparameters to use. For
instance, [0,0,1,1,0 …] assigns H to group 0, He and Li to group 1,
and Be to group 0 (the 0th register is ignored).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nspec: Integer, number of different species groups (equal to number of</dt><dd><p>unique values in spec_mask).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nbond: Integer, number of different hyperparameter sets to associate with</dt><dd><p>different 2-body pairings of atoms in groups defined in spec_mask.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bond_mask: Array of length nspec^2, which describes the hyperparameter sets to</dt><dd><p>associate with different pairings of species types. For example, if there
are atoms of type 0 and 1, then bond_mask defines which hyperparameters
to use for parings [0-0, 0-1, 1-0, 1-1]: if we wanted hyperparameter set 0 for
0-0 parings and set 1 for 0-1 and 1-1 pairings, then we would make
bond_mask [0, 1, 1, 1].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ntriplet: Integer, number of different hyperparameter sets to associate</dt><dd><p>with different 3-body pariings of atoms in groups defined in spec_mask.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>triplet_mask: Similar to bond mask: Triplet pairings of type 0 and 1 atoms</dt><dd><p>would go {0-0-0, 0-0-1, 0-1-0, 0-1-1, 1-0-0, 1-0-1, 1-1-0, 1-1-1},
and if we wanted hyp. set 0 for triplets with only atoms of type 0
and hyp. set 1 for all the rest, then the triplet_mask array would
read [0,1,1,1,1,1,1,1]. The user should make sure that the mask has
a permutational symmetry.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cutoff_2b: Array of length nbond, which stores the cutoff used for different</dt><dd><p>types of bonds defined in bond_mask</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ncut3b:    Integer, number of different cutoffs sets to associate</dt><dd><p>with different 3-body pariings of atoms in groups defined in spec_mask.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cut3b_mask: Array of length nspec^2, which describes the cutoff to</dt><dd><p>associate with different bond types in triplets. For example, in a triplet
(C, O, H) , there are three cutoffs. Cutoffs for CH bond, CO bond and OH bond.
If C and O are associate with atom group 1 in spec_mask and H are associate with
group 0 in spec_mask, the cut3b_mask[1*nspec+0] determines the C/O-H bond cutoff,
and cut3b_mask[1*nspec+1] determines the C-O bond cutoff. If we want the
former one to use the 1st cutoff in cutoff_3b and the later to use the 2nd cutoff
in cutoff_3b, the cut3b_mask should be [0, 0, 0, 1]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cutoff_3b: Array of length ncut3b, which stores the cutoff used for different</dt><dd><p>types of bonds in triplets.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nmb<span class="classifier">Integer, number of different cutoffs set to associate with different coordination</span></dt><dd><p>numbers</p>
</dd>
</dl>
</li>
<li><p>mb_mask:   similar to bond_mask and cut3b_mask.</p></li>
<li><p>cutoff_mb: Array of length nmb, stores the cutoff used for different many body terms</p></li>
</ul>
<p>For selective optimization. one can define ‘map’, ‘train_noise’ and ‘original’
to identify which element to be optimized. All three have to be defined.
train_noise = Bool (True/False), whether the noise parameter can be optimized
original: np.array. Full set of initial values for hyperparmeters
map: np.array, array to map the hyper parameter back to the full set.
map[i]=j means the i-th element in hyps should be the j-th element in
hyps_mask[‘original’]</p>
<p>For example, the full set of hyper parmeters
may include [ls21, ls22, sig21, sig22, ls3
sg3, noise] but suppose you wanted only the set 21 optimized.
The full set of hyperparameters is defined in ‘original’; include all those
you want to leave static, and set initial guesses for those you want to vary.
Have the ‘map’ list contain the indices of the hyperparameters in ‘original’
that correspond to the hyperparameters you want to vary.
Have a hyps list which contain those which you want to vary. Below,
ls21, ls22 etc… represent floating-point variables which correspond
to the initial guesses / static values.
You would then pass in:</p>
<p>hyps = [ls21, sig21]
hyps_mask = { …, ‘train_noise’: False, ‘map’:[0, 2],</p>
<blockquote>
<div><p>‘original’: [ls21, ls22, sig21, sig22, ls3, sg3, noise]}</p>
</div></blockquote>
<p>the hyps argument should only contain the values that need to be optimized.
If you want noise to be trained as well include noise as the
final hyperparameter value in hyps.</p>
<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.many_body_mc">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">many_body_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc" title="Link to this definition"></a></dt>
<dd><p>many-body multi-element kernel between two force components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> – dummy</p></li>
<li><p><strong>cutoff_3b</strong> – dummy</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> – dummy</p></li>
<li><p><strong>bond_mask</strong> – dummy</p></li>
<li><p><strong>ntriplet</strong> – dummy</p></li>
<li><p><strong>triplet_mask</strong> – dummy</p></li>
<li><p><strong>ncut3b</strong> – dummy</p></li>
<li><p><strong>cut3b_mask</strong> – dummy</p></li>
<li><p><strong>nmb</strong> (<em>int</em>) – number of different hyperparameter sets to associate with manybody pairings</p></li>
<li><p><strong>mb_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> – dummy</p></li>
<li><p><strong>ls3</strong> – dummy</p></li>
<li><p><strong>sigm</strong> (<em>np.ndarray</em>) – signal variances associates with manybody term</p></li>
<li><p><strong>lsm</strong> (<em>np.ndarray</em>) – length scales associates with manybody term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+many-body kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.many_body_mc_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc_en" title="Link to this definition"></a></dt>
<dd><p>many-body multi-element kernel between two local energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>hyps</strong> (<em>np.ndarray</em>) – Hyperparameters of the kernel function (sig, ls).</p></li>
<li><p><strong>cutoffs</strong> (<em>np.ndarray</em>) – One-element array containing the 2-body
cutoff.</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2-body force/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.many_body_mc_force_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_force_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc_force_en" title="Link to this definition"></a></dt>
<dd><p>many-body single-element kernel between two local energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>hyps</strong> (<em>np.ndarray</em>) – Hyperparameters of the kernel function (sig, ls).</p></li>
<li><p><strong>cutoffs</strong> (<em>np.ndarray</em>) – Two-element array containing the 2-, 3-, and
many-body cutoffs.</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the many-body force/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.many_body_mc_grad">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc_grad" title="Link to this definition"></a></dt>
<dd><p>manybody multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> – dummy</p></li>
<li><p><strong>cutoff_3b</strong> – dummy</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> – dummy</p></li>
<li><p><strong>bond_mask</strong> – dummy</p></li>
<li><p><strong>ntriplet</strong> – dummy</p></li>
<li><p><strong>triplet_mask</strong> – dummy</p></li>
<li><p><strong>ncut3b</strong> – dummy</p></li>
<li><p><strong>cut3b_mask</strong> – dummy</p></li>
<li><p><strong>nmb</strong> (<em>int</em>) – number of different hyperparameter sets to associate with manybody pairings</p></li>
<li><p><strong>mb_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> – dummy</p></li>
<li><p><strong>ls3</strong> – dummy</p></li>
<li><p><strong>sigm</strong> (<em>np.ndarray</em>) – signal variances associates with manybody term</p></li>
<li><p><strong>lsm</strong> (<em>np.ndarray</em>) – length scales associates with manybody term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+manybody kernel and its gradient
with respect to the hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float, np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.three_body_mc">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">three_body_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc" title="Link to this definition"></a></dt>
<dd><p>3-body multi-element kernel between two force components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> – dummy</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> – dummy</p></li>
<li><p><strong>bond_mask</strong> – dummy</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body force/force kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.three_body_mc_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_en" title="Link to this definition"></a></dt>
<dd><p>3-body multi-element kernel between two local energies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> – dummy</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> – dummy</p></li>
<li><p><strong>bond_mask</strong> – dummy</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body energy/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.three_body_mc_force_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_force_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_force_en" title="Link to this definition"></a></dt>
<dd><p>3-body multi-element kernel between a force component and local energies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> – dummy</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> – dummy</p></li>
<li><p><strong>bond_mask</strong> – dummy</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body force/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.three_body_mc_force_en_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_force_en_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_force_en_jit" title="Link to this definition"></a></dt>
<dd><p>Kernel for 3-body force/energy comparisons.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.three_body_mc_grad">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_grad" title="Link to this definition"></a></dt>
<dd><p>3-body multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> – dummy</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> – dummy</p></li>
<li><p><strong>bond_mask</strong> – dummy</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+manybody kernel and its gradient
with respect to the hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float, np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.three_body_mc_grad_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_grad_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_grad_jit" title="Link to this definition"></a></dt>
<dd><p>Kernel gradient for 3-body force comparisons.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc" title="Link to this definition"></a></dt>
<dd><p>2-body multi-element kernel between two force components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> – dummy</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> – dummy</p></li>
<li><p><strong>triplet_mask</strong> – dummy</p></li>
<li><p><strong>ncut3b</strong> – dummy</p></li>
<li><p><strong>cut3b_mask</strong> – dummy</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> – dummy</p></li>
<li><p><strong>ls3</strong> – dummy</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2-body force/force kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_en" title="Link to this definition"></a></dt>
<dd><p>2-body multi-element kernel between two local energies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> – dummy</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> – dummy</p></li>
<li><p><strong>triplet_mask</strong> – dummy</p></li>
<li><p><strong>ncut3b</strong> – dummy</p></li>
<li><p><strong>cut3b_mask</strong> – dummy</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> – dummy</p></li>
<li><p><strong>ls3</strong> – dummy</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2-body energy/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_en_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_en_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_en_jit" title="Link to this definition"></a></dt>
<dd><p>Multicomponent two-body energy/energy kernel accelerated with
Numba’s njit decorator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_force_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_force_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_force_en" title="Link to this definition"></a></dt>
<dd><p>2-body multi-element kernel between a force components and local energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> – dummy</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> – dummy</p></li>
<li><p><strong>triplet_mask</strong> – dummy</p></li>
<li><p><strong>ncut3b</strong> – dummy</p></li>
<li><p><strong>cut3b_mask</strong> – dummy</p></li>
<li><p><strong>sig2</strong> – dummy</p></li>
<li><p><strong>ls2</strong> – dummy</p></li>
<li><p><strong>sig3</strong> – dummy</p></li>
<li><p><strong>ls3</strong> – dummy</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2-body force/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_force_en_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_force_en_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_force_en_jit" title="Link to this definition"></a></dt>
<dd><p>Multicomponent two-body force/energy kernel accelerated with
Numba’s njit decorator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_grad">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_grad" title="Link to this definition"></a></dt>
<dd><p>2-body multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> – dummy</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> – dummy</p></li>
<li><p><strong>triplet_mask</strong> – dummy</p></li>
<li><p><strong>ncut3b</strong> – dummy</p></li>
<li><p><strong>cut3b_mask</strong> – dummy</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> – dummy</p></li>
<li><p><strong>ls3</strong> – dummy</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2-body kernel and its gradient
with respect to the hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float, np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_grad_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_grad_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_grad_jit" title="Link to this definition"></a></dt>
<dd><p>Multicomponent two-body force/force kernel gradient accelerated with
Numba’s njit decorator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_body_mc_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_body_mc_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_jit" title="Link to this definition"></a></dt>
<dd><p>Multicomponent two-body force/force kernel accelerated with Numba’s
njit decorator.
Loops over bonds in two environments and adds to the kernel if bonds are
of the same type.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_plus_three_body_mc">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_plus_three_body_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_body_mc" title="Link to this definition"></a></dt>
<dd><p>2+3-body multi-element kernel between two force components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body force/force kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_plus_three_body_mc_grad">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_plus_three_body_mc_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_body_mc_grad" title="Link to this definition"></a></dt>
<dd><p>2+3-body multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body kernel and its gradient
with respect to the hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float, np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_plus_three_mc_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_plus_three_mc_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_mc_en" title="Link to this definition"></a></dt>
<dd><p>2+3-body multi-element kernel between two local energies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body energy/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_plus_three_mc_force_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_plus_three_mc_force_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_mc_force_en" title="Link to this definition"></a></dt>
<dd><p>2+3-body multi-element kernel between force and local energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3-body force/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_three_many_body_mc">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_three_many_body_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_body_mc" title="Link to this definition"></a></dt>
<dd><p>2+3+manybody multi-element kernel between two force components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>nmb</strong> (<em>int</em>) – number of different hyperparameter sets to associate with manybody pairings</p></li>
<li><p><strong>mb_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>sigm</strong> (<em>np.ndarray</em>) – signal variances associates with manybody term</p></li>
<li><p><strong>lsm</strong> (<em>np.ndarray</em>) – length scales associates with manybody term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+many-body kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_three_many_body_mc_grad">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_three_many_body_mc_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_body_mc_grad" title="Link to this definition"></a></dt>
<dd><p>2+3+manybody multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>nmb</strong> (<em>int</em>) – number of different hyperparameter sets to associate with manybody pairings</p></li>
<li><p><strong>mb_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>sigm</strong> (<em>np.ndarray</em>) – signal variances associates with manybody term</p></li>
<li><p><strong>lsm</strong> (<em>np.ndarray</em>) – length scales associates with manybody term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+manybody kernel and its gradient
with respect to the hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float, np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_three_many_mc_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_three_many_mc_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_mc_en" title="Link to this definition"></a></dt>
<dd><p>2+3+many-body multi-element kernel between two local energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>nmb</strong> (<em>int</em>) – number of different hyperparameter sets to associate with manybody pairings</p></li>
<li><p><strong>mb_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>sigm</strong> (<em>np.ndarray</em>) – signal variances associates with manybody term</p></li>
<li><p><strong>lsm</strong> (<em>np.ndarray</em>) – length scales associates with manybody term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+many-body energy/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_sephyps.two_three_many_mc_force_en">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_sephyps.</span></span><span class="sig-name descname"><span class="pre">two_three_many_mc_force_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncut3b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">numba.njit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_mc_force_en" title="Link to this definition"></a></dt>
<dd><p>2+3+manybody multi-element kernel between a force component and a local
energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env1</strong> (<em>AtomicEnvironment</em>) – First local environment.</p></li>
<li><p><strong>env2</strong> (<em>AtomicEnvironment</em>) – Second local environment.</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for two-body interaction</p></li>
<li><p><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) – cutoff(s) for three-body interaction</p></li>
<li><p><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) – cutoff(s) for coordination-based manybody interaction</p></li>
<li><p><strong>nspec</strong> (<em>int</em>) – number of different species groups</p></li>
<li><p><strong>spec_mask</strong> (<em>np.ndarray</em>) – 118-long integer array that determines specie group</p></li>
<li><p><strong>nbond</strong> (<em>int</em>) – number of different hyperparameter sets to associate with two-body pairings</p></li>
<li><p><strong>bond_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>ntriplet</strong> (<em>int</em>) – number of different hyperparameter sets to associate with 3-body pairings</p></li>
<li><p><strong>triplet_mask</strong> (<em>np.ndarray</em>) – nspec^3 long integer array</p></li>
<li><p><strong>ncut3b</strong> (<em>int</em>) – number of different 3-body cutoff sets to associate with 3-body pairings</p></li>
<li><p><strong>cut3b_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>nmb</strong> (<em>int</em>) – number of different hyperparameter sets to associate with manybody pairings</p></li>
<li><p><strong>mb_mask</strong> (<em>np.ndarray</em>) – nspec^2 long integer array</p></li>
<li><p><strong>sig2</strong> (<em>np.ndarray</em>) – signal variances associates with two-body term</p></li>
<li><p><strong>ls2</strong> (<em>np.ndarray</em>) – length scales associates with two-body term</p></li>
<li><p><strong>sig3</strong> (<em>np.ndarray</em>) – signal variances associates with three-body term</p></li>
<li><p><strong>ls3</strong> (<em>np.ndarray</em>) – length scales associates with three-body term</p></li>
<li><p><strong>sigm</strong> (<em>np.ndarray</em>) – signal variances associates with manybody term</p></li>
<li><p><strong>lsm</strong> (<em>np.ndarray</em>) – length scales associates with manybody term</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function of the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the 2+3+many-body force/energy kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p id="module-flare.kernels.mc_3b_sepcut">Implementation of three-body kernels using different cutoffs.</p>
<p>The kernels are slightly slower.</p>
<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_3b_sepcut.three_body_mc_force_en_sepcut_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_3b_sepcut.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_force_en_sepcut_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_3b_sepcut.three_body_mc_force_en_sepcut_jit" title="Link to this definition"></a></dt>
<dd><p>Kernel for 3-body force/energy comparisons.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_3b_sepcut.three_body_mc_grad_sepcut_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_3b_sepcut.</span></span><span class="sig-name descname"><span class="pre">three_body_mc_grad_sepcut_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_inds_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_bond_dists_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplets_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut3b_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_3b_sepcut.three_body_mc_grad_sepcut_jit" title="Link to this definition"></a></dt>
<dd><p>Kernel gradient for 3-body force comparisons.</p>
</dd></dl>

<p id="module-flare.kernels.mc_mb_sepcut">Implementation of three-body kernels using different cutoffs.</p>
<p>The kernels are slightly slower.</p>
<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_mb_sepcut.many_body_mc_en_sepcut_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_mb_sepcut.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_en_sepcut_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_en_sepcut_jit" title="Link to this definition"></a></dt>
<dd><p>many-body many-element kernel between energy components accelerated
with Numba.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_array_1</strong> (<em>np.ndarray</em>) – many-body bond array of the first local
environment.</p></li>
<li><p><strong>bond_array_2</strong> (<em>np.ndarray</em>) – many-body bond array of the second local
environment.</p></li>
<li><p><strong>c1</strong> (<em>int</em>) – atomic species of the central atom in env 1</p></li>
<li><p><strong>c2</strong> (<em>int</em>) – atomic species of the central atom in env 2</p></li>
<li><p><strong>etypes1</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 1</p></li>
<li><p><strong>etypes2</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 2</p></li>
<li><p><strong>species1</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 1</p></li>
<li><p><strong>species2</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 2</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – many-body signal variance hyperparameter.</p></li>
<li><p><strong>ls</strong> (<em>float</em>) – many-body length scale hyperparameter.</p></li>
<li><p><strong>r_cut</strong> (<em>float</em>) – many-body cutoff radius.</p></li>
<li><p><strong>cutoff_func</strong> (<em>Callable</em>) – Cutoff function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the many-body kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_mb_sepcut.many_body_mc_force_en_sepcut_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_mb_sepcut.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_force_en_sepcut_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_grads_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_force_en_sepcut_jit" title="Link to this definition"></a></dt>
<dd><p>many-body many-element kernel between force and energy components accelerated
with Numba.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>To be complete</strong></p></li>
<li><p><strong>c1</strong> (<em>int</em>) – atomic species of the central atom in env 1</p></li>
<li><p><strong>c2</strong> (<em>int</em>) – atomic species of the central atom in env 2</p></li>
<li><p><strong>etypes1</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 1</p></li>
<li><p><strong>species1</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 1</p></li>
<li><p><strong>species2</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 2</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – many-body signal variance hyperparameter.</p></li>
<li><p><strong>ls</strong> (<em>float</em>) – many-body length scale hyperparameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the many-body kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_mb_sepcut.many_body_mc_grad_sepcut_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_mb_sepcut.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_grad_sepcut_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_grads_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_grads_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_grad_sepcut_jit" title="Link to this definition"></a></dt>
<dd><p>gradient of many-body multi-element kernel between two force components
w.r.t. the hyperparameters, accelerated with Numba.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c1</strong> (<em>int</em>) – atomic species of the central atom in env 1</p></li>
<li><p><strong>c2</strong> (<em>int</em>) – atomic species of the central atom in env 2</p></li>
<li><p><strong>etypes1</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 1</p></li>
<li><p><strong>etypes2</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 2</p></li>
<li><p><strong>species1</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 1</p></li>
<li><p><strong>species2</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 2</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – many-body signal variance hyperparameter.</p></li>
<li><p><strong>ls</strong> (<em>float</em>) – many-body length scale hyperparameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the many-body kernel and its gradient w.r.t. sig and ls</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flare.kernels.mc_mb_sepcut.many_body_mc_sepcut_jit">
<span class="sig-prename descclassname"><span class="pre">flare.kernels.mc_mb_sepcut.</span></span><span class="sig-name descname"><span class="pre">many_body_mc_sepcut_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_grads_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_neigh_grads_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mb_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_sepcut_jit" title="Link to this definition"></a></dt>
<dd><p>many-body multi-element kernel between two force components accelerated
with Numba.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c1</strong> (<em>int</em>) – atomic species of the central atom in env 1</p></li>
<li><p><strong>c2</strong> (<em>int</em>) – atomic species of the central atom in env 2</p></li>
<li><p><strong>etypes1</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 1</p></li>
<li><p><strong>etypes2</strong> (<em>np.ndarray</em>) – atomic species of atoms in env 2</p></li>
<li><p><strong>species1</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 1</p></li>
<li><p><strong>species2</strong> (<em>np.ndarray</em>) – all the atomic species present in trajectory 2</p></li>
<li><p><strong>d1</strong> (<em>int</em>) – Force component of the first environment.</p></li>
<li><p><strong>d2</strong> (<em>int</em>) – Force component of the second environment.</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – many-body signal variance hyperparameter.</p></li>
<li><p><strong>ls</strong> (<em>float</em>) – many-body length scale hyperparameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the many-body kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mc_simple.html" class="btn btn-neutral float-left" title="Multi-element Kernels (simple)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cutoffs.html" class="btn btn-neutral float-right" title="Cutoff Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jonathan Vandermause, Yu Xie, Anders Johansson, Cameron Owen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>